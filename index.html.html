<script>
  function calculate() {
    const dims = document.getElementById('dimensions').value.split('*');
    const yuan = parseFloat(document.getElementById('yuan').value);
    const rate = parseFloat(document.getElementById('rate').value);
    const qty = parseInt(document.getElementById('quantity').value);

    if (dims.length !== 3 || isNaN(yuan) || isNaN(rate) || isNaN(qty) || qty <= 0) {
      document.getElementById('output').innerHTML = "⚠️ تأكد من إدخال الأبعاد وسعر اليوان وسعر الصرف وعدد القطع بشكل صحيح";
      return;
    }

    const [l, w, h] = dims.map(Number);
    const volume = l * w * h / 1000000;

    // ✅ تكلفة الشحن (تم التعديل)
    const shipping = volume * 109 * 1350;
    const shippingPerUnit = shipping / qty;

    // ✅ تحويل اليوان إلى دولار ثم إلى دينار (1380)
    const usdPrice = yuan / rate;
    const itemCostIQD = usdPrice * 1380;

    // ✅ السعر النهائي
    const totalCost = shippingPerUnit + itemCostIQD + 3000;

    document.getElementById('output').innerHTML = `
      ✅ حجم الكارتون: ${volume.toFixed(4)} م³<br>
      🚚 شحن الكارتون: ${shipping.toFixed(2)} دينار<br>
      📦 شحن للقطعة: ${shippingPerUnit.toFixed(2)} دينار<br>
      💰 سعر القطعة بالدينار: ${itemCostIQD.toFixed(2)} دينار<br>
      💳 السعر النهائي للقطعة: ${totalCost.toFixed(2)} دينار
    `;
  }
</script>
